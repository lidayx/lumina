import { WebSearchResult, SearchEngine, WebSearchHistory } from '../../shared/types/web';
import { browserService } from './browserService';

/**
 * 搜索引擎配置接口（内部使用）
 */
interface SearchEngineConfigData {
  default: boolean;
  order?: number;
  addedAt?: string;
  updatedAt?: string;
}

/**
 * 网页搜索服务
 */
class WebService {
  // ========== 常量 ==========
  private readonly CONFIG_ITEM_ID = 'search-engine-config';
  private readonly SEARCH_ENGINE_PREFIX = 'search-engine-';
  private readonly DEFAULT_ENGINE_NAME = '百度';
  
  // ========== 私有属性 ==========
  private searchEngines: Map<string, SearchEngine> = new Map();
  private defaultEngine: string = '百度';
  private searchHistory: Map<string, WebSearchHistory> = new Map();

  constructor() {
    console.log('WebService 初始化...');
    // 异步初始化，不阻塞构造函数
    (async () => {
      await this.loadSearchEngines();
    })().catch(err => {
      console.error('WebService 初始化失败:', err);
    });
  }

  // ========== 初始化相关 ==========

  /**
   * 加载搜索引擎
   */
  private async loadSearchEngines(): Promise<void> {
    try {
      await this.loadDefaultEngineName();
      await this.loadSearchEnginesFromDatabase();
      
      if (this.searchEngines.size === 0) {
        await this.initDefaultEngines();
      }
    } catch (error) {
      console.error('加载搜索引擎失败:', error);
      await this.initDefaultEngines();
    }
  }

  /**
   * 初始化默认搜索引擎
   */
  private async initDefaultEngines(): Promise<void> {
    const engines: SearchEngine[] = [
      { name: '百度', url: 'https://www.baidu.com/s?wd=', default: true, icon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAQAElEQVR4AeydC3rkNg6Ee/diSU6W3ZMlOdmk/4xhK7IefAAgSCGfEUkUCRQKKFHtsWf++8r/rhj49X3zjw/78T6Kydj/3mPY+5BfKzKQAvleVREFYkAIXGPbmVxjv78HMeamUN5krPaVAvmqKA2PIDDOv+6UnaVQyniaalYK5Ge5ePq3CuOnh6//IxR8fY3k2bQMpEBeL8RBU78U//v17YvXLo7v0+m+wL236ZLQAGwoEA145j540muLYwsa/whwOxb1HEGAF2Fz3Bvjs+SixvGTBUID0BRqZJ44QoAecU7C3w7DA83P8Q4nuTD3MUJ5qkAo8F0z3HZWxYSS5qtwpzKV/Gl2jrUOHyOUJwoEcVDg2qbonR9JJGDBenOCR/y0iKw3tsv6pwlklDikmDSUnI840situ8YZXnwiErg9mzPt+JwCaac7QoOOaiRp5Hb2rlfC7ajcrpF13H2SQKIUj0aiWTvKVr2UeDzlqxdWLiC3KDxXQj+e/iSBULxjFvxHPbF4iUNYJLdlRPIUgUQrGE2LSVNZHYnhsXPs8S8jkqcIhILtizj62hrTKHEIr+QHBrme8vgEgVTtHo5VtG6eETvHnj5Esh+b6voJAolcJCuRRHkokF8ULE3CXF0gFKiJGKdFFuKlIS38tlICluh1OM0tBXJKjcsNGgfTDEZDavrT8BURU1FeqwvklyIW1pkU4XPHEZs8BLCje6HHVhdIpKKcNYLW05VXq8j5auV5xqPJ+MoCoWFMSAvqNHoDIl4sKH3HsFYWyHHG8UZpGqwH2SwPg+gi/laDlQXypM8fszRe74PgWwNbD6wskJmK0dPgs+we0ssz1eW1skCkIKsff3+9pkqx52HgnuiqApnqKdVR9dl2j45UxyxdVSBj2MyoJQxM9fBaVSBTFeHdVa14Z/1GRGu+b6p8v1YViC+L46JN02jjKOqLnALp42/kap/PHyMzDBA7BRKgCAkhLgMpkLi1uUM26+ePu7xC3V9VIH+GYjnBTMvAqgKZrSAtgs4P6A5VToE4kJwhjhmYYTQFEqNKf8WA4YaiZcd0A7cNtKpApinAthgPOZ+qNqsKhF6bqhAAfohNtVuuLJCZ+q1WzDN/QK/NdWgdVxbI/4cyWxe8tmlq59ehsZ3tgV0tg5UFokaSsaOZhNxLxXS5riwQnlRYb1Gjrl85tzCcryyQMCTfAHnSDx1Ol+vqAom+pUfHd6PtqttT5jpCIJ7fgeE1BKuq5CSTp/p26ZvT6XaPN+aDv7SBUT1DDPx1mNiPt1tsey7XkIe9p6h/RW4kq5zVSex0OOXuQc5WOwiFl+ZHJBjxjox7/E0XGGtYezSvdSzqDtLbNFHzaq1TyHXaAqG5aXKavTVh1uIDX60+tutopN5m3PrTOu/Nj7y0sFj6gfveXC3xXfrWFAivTjT3ZcCKm/jSEkq0AtE0FVScTp1BJNG4PyXz6IaGQHhFopE5HsXoHUMoGiT/1gtEcb1GPsDREhq+LCw6vtucewVCodk5bgMxocMQCXF6RMjTFuuAobJUs2nIB1MBZuCE/jBw6+eyVyA0rhdaxNErEs3mbMmb+NpNg88WLNZrouKqyrtHIDRrVTClycRFLC3ueNqOfNXSFgcckBPGeRRDHBa5uufXKhCSb21SjSR7RUIBNXDU+LAU5oh8znIHC/1xdn+q8RaBkLznq9UZoYjk7N7dODlQyLt5WvcRh+VTHt+YFt5WP2CA29b14da1CCRSEiKSFkwU0kMk1uKQ3L3iSLyjIxiOxqcdqxUITRVh9xDCec0Dk1zXHllrKRIahqdqLa7W+Za5XGEiR3K9mjPlvVqBRBKHEA4mhCLXtUcLkdAw/3kD4fg+uH0Rz7tRJSZHt0S9AtUIhEbywlUbB5HUrtnOJzcauvcJTJPQoNjWv+c5GDRyKcEMXyNzLcHYNadGIL1N2AX0ZjE7CE1+M+32Nj5amoumpFEwzm8DOUwgFxrYIhQ5kisxLPyLT+oqJmOux1KBWBOhkbSmgMkXofz2er1oMoym2BpjNIkY9zTy0PQheYBVwy85WuSLCMDKN134sSUxrsVkjCNjzGedRl6nPkoFcuog2A2I04REQ1AITBpDjoxxH9OMaeELrAgeobTgZY3kzbkGRpqbeknD84BjrMQ385gv68mvZF31nFKBAKba+YAFEDcg7DQhaSQaXcSCYDCafmuMYTKXI/c1EqVGNDbGuYZP+hOhkR+m4fMfHyUCUQ34T1Tb/2mRbotyvHfqKoYAtibjWqKQbPGrKQzxK0eEghFHxrqOJQKZ7R9qgaAuUnKxCQM0rVdtiCM7SlcyJQKZ7Yk8D96u0k212FMcW2IQCrG3Y1XndwLpcl6FRHdyikSXzx5v9BCN2uOjZy2xwdDk404gTU5zUTLwwQCNSYN+XA47gAEs1QDuBDLb5w8hAELkPI9jGGAXj1QHsICpio07gVQ7rIqek1dmgO9WRcsPTFU9fSeQaAkmnkIGBk9rep1xwsxOUhzqSiBVSiuOmBOfwEBVEzoTQl9jRWFTIEU05aQKBiLvHpIGr1pyfnm8EsjlwryZDEzOQNEukgKZvMoB4Ud+vdrSVYQzBbKlLM9LGLiaU/RUvnLgeA+s2GXIFMglPXmzkoHbhqv0Zz39dhe5Esisf0hoTWr6P2dgtp5B0NhpRlcCOV2UN5KBEwYum+1kTejhK4FE/peZ7kidGftdblHvz/Dt3SPuLl+zrgSi/csyR+CeOMZTFuN78WL87sLWZJymw5j/AK7ipXglkHhoyxFFEjfNTZPT9IiAI8a42D4zGefphjGftfjB9vPzup0BuD5dfSWQSE12msDJjQjYIZ7Gxmhyrk/gFg/jBxOxFC90mDjbB/QtJae1uRIIDiI0GjhmMshGFBjnVtijCsUq3yF+7wQyBFRn0FGi5tUHUWCWwtjTE0UonjnvOei9PsV+JxD+6pfe4N7rR3wHC1HQqKdEO5BAfETqEGrCEI2Q7wQy6mncmI77MgTB5wGO7sEPAiIS8HgLJUr+B5T0Dd0JBO+zicQLL03IzgFH0QyhgC8arunwlAhkttcsD4EgDJowcsHBlyLprFCJQDwarjONz+UeYkYcs7xSIBLwfhKUJ3UMlAgEjx6NR5xes35i0myziEO4BC+45TqPFQyUCAR31o1HjF6zFjFNRrP14hyxHtzgHxF76pilAiFJ6wYkRo9ZihjfNFkPvtFrwZ8iqaxCjUBokqifRyzFS968y1dSG3I6IiGfkOAigqoRCPgtGxH/rWZVdPyuIg7hlnzIS67z+HqdPvhrBYKjaCLh37V4Gf1HMxm5HuqWvNhNtEDQF1q+Rvg5xV8rEMDz9Dl1yIRy656JWK2wkGc3wMAOEElgeDGgtQgE5Dy1rRoT/yWGOKyaGL+rNxA7CHmWcF0yZ3Q/lGCsntMqEAKNFImlOMhtdXGQI0aeCIXzp9qlsHsEAqE0KkdPI6bmk2+P/WnfCiVfDZGM+Cnqfe3Ur3sFgvrkX0xVB7dzSCx2LUtx4FujWXbQw1+yk/SCpD69PkasvxR2r0AkIRqLJ7tcax8hH3FwLPNdP4scNBqlPvL4FTwU2El6kFjWpgfX3dpL3FoCAQQNpr2bIDp8Ig5iWBkN8lRxCKdwQA3l+ilHN4EIoZBMU9Pcl8FlwebIfAxB4ANfm9tmp08XhxALDwhFrmuP1K52zcj59OhlfM0dZB+I5pZG5wgYMYiUc47c3xr39/6srsHZ0xRWuEb55VWrlQ9qOQq3SVxLgWwB0/A0ohhikHOO3Me2azzOic1T0yPWTDFaOaGG2Cy5Uv9LrF4CuQQx6CZPyaZGGITXMyzc3DbPCaBZdpEinE8WCK8SJzXO4TcDPDxaRMIOgr1dhP4qyu2pAklxlPUuImE3KZv9Navo6fw13f2sGN8TBYI4WoruXsUgAVv4YgcpbkLnPMFVtHuA62kCaSk2PD3d2ElqOaAJacbaddbzwVUc40kCmUEcxYVznsiOC3+1YWlGdpPadVbzqwX7FIFQXIqsTTx/mFlr1UXSBt3oD/7gsXY539KPIBJ4R7BV+J8gEIpKcauIycmHDMAjfB7evBhEJDToxRTTW8SvFgeIVhcIpFBUck3TYQA+W0RCLbxFws6FODg2Zb+yQChIy4fLJiIftgiRwG9t2qzhldRaKAgCYWCc1+L8nL+qQHjCpTg+y8yJusEvDd/imHUiFE2xIAZEgXHegu1fa1YTCE82xMHxX4nmhQkDPSIBEELBEAtNjVgwmluMeXuTe8xlHSY+uLef33y9kkAQRYqjuRWaF/aKRALT2IgFo+HFaPy9yT3msg4TP6rHVQQi4lAlJ50VM6AlkuKAXhNXEAhPEXYOL84yzjEDS4pkdoEgDgpzXLIc9WHgKwq1oCZfI5OfzSwQCkFBJi/BcvCpCbVZIrFZBcIrFYVYoggLJkFtlhDJbAKRD+McF+yrpVJCJDzIpk5qJoHwRILwFMc8LUetqNk8iHdIZxEI4uCJtIOflxMw0CWS0fnNIBCeQCmO0Z3SF39akUQWCKT+eNeF4/uQX5MzQB2nq2dUgfBKxc4xeU8k/AMGqCtiObgVbyiiQBBHvlLF6xVNRIiEOmv6NPEVTSAQ5yEOfrgNkx962/8wXOm1SVEe4pQ6jxRJEc2RBII4LLdeEQTNL8JgDCsiy2ESWMBXa5rQtj9CLjzdHVnTgiG8SCIIBFFYioOmkwJz3lLIp62Bp1pr5QiRUP/W9abrRgvEUhwUOIVh2j5qzumDkN/hGikQSLF6crDlIw5EolbFRkfk2bj0ccvoh1CfS0YKBDIsOgBhRCI5gkgteLbyyStXmPq1CaSfGgtx0IiIg2M/wvQwkoEwIhkhEJ4OFq8dvFZ5icMC/8iGjBgbkVg8SKty9RYI4iDxKpAFk73EIcLwEmJB6ktPge+hH949BWIpDnx7dEoKw4Pl7zHYSRDL9zvGI54Csdo5rMQxpCDG9Z7Z/RCReAmkuIkrKsjTXMsvYqAAbOdi+2sZ3x4r4OZUBQYsHrKXsDwEQhNbJPbXZWZlN8FGwyMGRFK2KmeNYoAaUSu3+B4CsRAHBNHcHFtMiLbC1oIp15QxQO16al8W5WOWtUCsEuG7Vh8pVB/AxFMIoqsX54IQDPBgc6mftUBIxIJRmrzFL+usMLXgyTXtDLjU0VIgNGN7+ucrW3cPnjgupJ5DzzuKDFBPTNHld1eWArFqxlbh8Vr1nYEcmZkBqx775MRKIK1N/Ans5IRv7Z7cuhy2wnMZNG+aM8AOgpkFshKIubLNGEnHszFg2msWArF8Wrf+2YcpibN11GJ42UEwk7QsBGICtMOpGXlfmPJsMANmD0ALgZiBHVyEDP9ABiwE8kAaM+XBDPCWgKnD0BaICchN1i3fxbLGtIGXpwMZMKnzbAJp4b9FVC1xcs1YBn6xCK8tEAuMW58mT4ltgHDnCWgoA9oCMVHxUIYy+CwMmDw8tQViAnJToRYBmYuergAABB1JREFU5ivWhsDFT9X7T1sgUflPkUStTHBcTxFI608ABy9fwrNmYDaBsIVitbywg2C165aen8ndMzCbQMioRSCsy10EFtKqGNAWiMdTuuWDOqSADeM8LRkoYkBbIEVBOyexg2AtblbdRVL4Ld1QsGZGgRSkdTqFRuIvuD6dMOmN1l8DmDRdP9jaAvEqVM+vzyIS/omzlXYTfgeHvPw65zrSqLvqHGgLRB3gBdM0xcXt21usRyTY7eQJJrAzrpJLGLpnFgi/d9L6WUQKgEgwdhSMJqsx8aN11MinJY9tzp4POS3e8GOCW1sgZkBxfGCI5GC4eQiSa6w50MXCXpHguiaHo7n4SHszYCGQt1u3L5qJHcAtoEMgbdE7QA4RwuTzr4VAvN+DaSiEEqJKCiBWykWBjr0L32sLgfhm8DMa39VaqbFW2xV/Vsn2/yacWQhE3mlt6fjufSWRrLYrfq+W7gg9p+vxw5uFQHDt/ZpFTAyRmDxJcO5s5OIcctpwJp8/YMNKICgaI4a38fRNkXizPjaeWa9ZCQS6zFSN8xtDJPzLUbMLhc9VK+RxU67u2zoCOYBhKRAz0Ad5nA2tIpRV8jirU8+46eu8tUAiiATytw02865CHnw2IQeM3J5upjxYCoTCmaqbAJVGg2G8tuyNxvOw1t9nkVR57SIHTHLwwH0VAyyCz/No3l/WAmEHMU9CqSI0npcpQf5044X7Ks4nmJVOrAUCV2yBCIXztGRAiwF6it7S8nfoR0sgh843g7PsIhvIeRqcAZfvknoJBLWnSIJ33ETw6CXz3QM+vARCLBJCKJynJQM9DNBLPeuL13oKBFAon2NaMtDKgGsPeQuEHYTfXmslJ9c9mwHE4bZ7QLW3QIhZKRKWpCUDL3dxwPkIgRA3RQILaaUM0C+uO4cAGyUQ4pM0r1scuU5LBo4YoD/ok6N75mMjBUJykjzbJ9dpycCWAfpimDgAMlogYMDYPvnraiCE6xWNh4EYeYrRAHJ+dpR1K/JylhO80Bdn913GowhEkoUQmkSubY823qWZKTCG8DHOxchTjPlyfnaUdfjBuIYnjPU2mYzxSj7kyHEMgk3UaAIBGk0CQdIEjEU0CojRpGDFBDfn3MMssOMXnjBiSVywYNy3iGvpE8zkglnGqfIdUSCSAITRABSfomOMyX3rI7HEiE3hxMAk52CUedaYrvyDASwY2AQj2Ll3tXbUPXCBD7wY16OwHMaNLJAtYIqOQSKFxziHXA3Dlxi+MbnmSGyKJ7bFFvkcvGAnB8kJvhgfiZv4YMLAx/VIPKexZxHIUQKQCrkahi+xo1irjJEjfNGYW8GIaLhvkSt+iYlJXMYsYqn6nFkgqkRoO5vEH02KYDCaF6OBxbhGPGLMvzPmsk4MX5zLukmo+QnzbwAAAP//6sCMjgAAAAZJREFUAwCGj351BeoP/wAAAABJRU5ErkJggg==' },
      { name: 'Google', url: 'https://www.google.com/search?q=', icon: 'data:image/png;base64,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' },
      { name: 'Bing', url: 'https://www.bing.com/search?q=', icon: 'data:image/png;base64,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' },
      { name: '知乎', url: 'https://www.zhihu.com/search?q=', icon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAANsklEQVR4AeydC3bEtg1FJ91Y2pW1XVmalaVzncjRGetHAiBB8vmYlkYiQeABV5Q8/vzjpQ8pIAVOFRAgp9LohBR4vQSIqkAKXCggQC7E0SkpIEBUA1LgQoFAQC5m1SkpMIgCAmSQRMnNPgoIkD66a9ZBFBAggyRKbvZRQID00V2zDqLAmIAMIq7cHF8BATJ+DhVBoAICJFBcmR5fAQEyfg4VQaACAiRQXJkeX4FZAPnnOxX/ebff3u2Pv9p7U/6pEVJgr8DIgADFBgTbf78D49h78/ovX9SkgFWB0QABAGBglWDLa6sGGi8FThUYBRBAAAga+6cB/XWC262/drWRAvUKjAAIQDwFAyV0e4UKai4KZAeElQA4SoJlTEn/Vn01z4AKZAaEQufBu0TW/5V0Vl8pcKdAVkBq4CDW3/miJgW8FMgKSOnKsekBWNu+tlLArEBGQGqLXA/n5nKQgU8FMgJSu3p8xrbQa4UapUA2QGpXD/SxjGW8mhT4oUA2QGpXD91e/UitDngokAkQywpgGeuho2xMqkAmQGpXD733MWlxZggrCyCWFUDvfURW0uK2swDyqyEPFrgM02roCgpkAIQfRqTV6K2H8xrVNOaxAlkAeeywOkqBlgpkAKT24RyddHuFCmphCvQGxFLgur0KK4s2hkeYpTcgWj18q4RnObXX60iDV81HT0AsqwfvfRyJMOqxmtx9jiF2frlM7fU60gB9PjW7fd0TkFvnLjoQ7JEIox7jj1BYLhgXUumURYGegFhurywxZx2LHgCe1b8l/eoFiK6Wx+W2rYzHZ3X0qQJu/XoBYnnn3C34pIaAhJbUvbXc6gEIyaetpXRZtNxulY1Q7xAFegESEoyMSgFvBXoAoqvjfRZZYWn3PdUjVIHWgOjhPDSdMu6twE9AvGeQvVoFtNLWKuc4rjUgSrpj8mQqXoGWgOj2qiyfegYp0yukd0tAtHqEpPDbqID6lsJvpxUgWj3qcqair9PNbVQrQL4cbvyFn/jdWuOph5yO368ZoTUVtxUg1tsrCp3k/eutzlH75X38s239GPc+XfXJvJ92W75m/irHCwcxD6t89oafhaHZurcABNFtXr5e/Gkf7CDQUbPa13gpcKhAC0AOJy48CByFQ9RdCtgVaAGI9fbKcotkV0gWllYgGpBWV/6lk6jg4xSIBsRj9RBkcfmX5RsFIgFRYd+Ir9P5FYgExBo9zx6CzKqixpsUiATEenvFt3NNwWmwFLAqEAWI9crP6pEEEKvEGj+yAlGAWDWxAmadX+OlwJcCUYBYbq9YPb6c0xcp0FuBCEAsV3/gsIzvrafmn0yBCEBq/+aV4JisuGYIxxsQfn+BVqrNmnCUqqT+zRWIAKQ0CMFRqpj6N1PAG5DSh/MWcOjbxc3Kab6JPAEpfbjmF5pKx8yXAUWUWgFPQJ4GyhWd38pj+3SM+kmBLgp4AnJ3ewUQrBq0LsGuNKli9VHAC5CrW6U9GOz7eC4rUqCBAp6A8MC9NVYJGrdSbAVGg2RqCn8FvADBM1aRrQEEjeNqUmBYBTwBGVYEOS4FzhQQIGfK6PiZAksdFyBLpVvBliogQEoVU/+lFBAgS6VbwZYqIEBKFVP/pRQQIEulO3uw+fwTIPlyIo8SKSBAEiVDruRTQIDky4k8SqSAAEmUDLmSTwEBki8n8ihCgUqbAqRSOA1bQwEBskaeFWWlAgKkUjgNW0MBAbJGnhVlpQICpFI4DVtDgSeArKGEopQCBwoIkANRdEgKbAoIkE2J51v+9nBEe+6BejZToAUgFNNv74h6tvf0VZ/4/sd75L5FxbHNsf3hi/e0+uytQDQgJJuCotB6tt46l8zPH+CjoV3JOPUNUCASEBJMoi/c1qkLBdAODS+66FS0AlGAkFgSHO3/7PalYecMRwGixPollouNnzVZKlIgAhAltCgFt511sbmVKK5DBCBKqH+++AaHv1VZvFXAG5A8q8dt6EN10EWnU7q8AekUhqaVAjEKeAOiK11MnnSLFaPrrVVPQHR7dSu3OoymgCcgo8U+mr9aRTpkzBOQZW6vOuRJU3ZSwAsQXd06JVDTxiogQO715V/JZWi6CN3nyr2HFyA8oPMPO7O2WuH4p6T8E9IMDY1r49C4SgW8AKmcXsOkQG4FVgDEcuW1jK3JvMYkU2AFQGol57mjdqzGTaLACoD8Wpmr3yvHadhECqwAiL77M1HBtg5lBUBqNdXzR61yE42bHRAV+XexaqdGgdkBqdGEMbz/wVZtcQVmB6T2AX3xslD4mwKzA1L7gK5bs61CFt/ODEgtHIuXhMLfKyBA9mr8ua/njz91eP514p4zA6Lnj4kLt1VoMwNSe4ulHzFpVX0DzDMrILVwkDIBggpqXwoIkC8Zvr+cPX8AnL6z9S3TOjuzAuL5/AEY/AsHfuee/XWqI0GkvV2YFRCu+DXaft5eAQRgbLbY59j2WtvJFZgREEsB7wHBDkB8lgDHagH8tKXXyRWYEZBayffPH9st1ZktzguSM3UmOj4jIFzha1NE0T8tfss8tf5pXGMFZgOE2yKLhE/hYI4NJvbVxlPgkcezAfIo6JNONSsCkFihPHFHhzMoMBsgNUVuzQNzChKriknHzwRIzyIVJEkL3OrWTIBYtbCOBxJuuax2ND6RAjMBQoH2lpaH/N4+aH5HBeoAcXTAyZTl9or3P/jbu06uvASJl5IJ7MwCiFVK3kEHFKsdxnObJUhQYoI2CyCW26tt9WHrCQn2WpaI5w9otvQ79VwzAGIpxE8gsMVq4pE0oMWehy3Z6KTADIBQiJ7yfUJjsY1v3HJZbGhsRwXSAVKohfUKfTSeFcT7oV2QFCY2S/fRAbHcd1+tFEBydb40f6wkpWPUP4ECIwPC1T/yyox9L0jwE3sJUi4XShQYGZCSOI/6PilY+rCaHI0vPcYqgr3ScerfUYFRAaHQKLha6UpWhpK+d/7gM6vJXT+dT6LAqIDUyFc7hhVED+216g0+bkRArKsHKcMG26cNSLxXkqdzq19HBUYExCpXbaEDVe3YT5+5zcLe53G9TqbAaIBQVNzHW2RkNagdz/yW8ft5iQN7+2M99/Fl36J82S4O+7me7qNZlF+HdkcDxCoQxU07FOPhQa9VhOmIh4Jhv2fDB3zZmuX9pas4AIEf5NzmKd3i55V993MjAYK4VgE8/rUzgH08tJvcokhMBgIGU4g0T9MbGJ42w22NAgjJ8igkD8hICpB4rSTEhs1szcsv7AAH22wx3vozCiAecHgV9CYqsHnZzFg8HrdZaDQsHCR6BEAQ2aOAsEPMng2brCZWmx7xWX34HG/1CW08LmyffjV9nR0QL5G9rvRHyfGw7XG1PvLNeqwGEsawagwPB+JlB2QEkVlBPB/aycvfre9eqf4bHGz7eu40e2ZAWD2cwnx52nodfACJx0pyYLrroZJCR2NWjq4Oe0+eFRDELr16nWnTqnDxuXaukkI8izPq+BPfAMMrX1FxVNnNCAiF5ik29qrEqRjEXKwmFUPTDrnKBfAAB9u0AVgcywYIQl8lpDTW2it66Tz7/rM+j+xjZJ+LwdRwEGQ2QBAcv7waSfSyVWJnCEgeBsRFi7bvjq6eF7K97VT7mQDxhqPH6rEll9usnvNvfnhvAYU8LQEH4mUBhCsS4uOTV8Oml60aO8z/FBKAqpljP4afM8NOSduPv9oHCPIDHGyv+p6dK/Erou+ZX5fHMwBCIZGAS0cLTz4tzEKzxd2JjWQXD6wYwFzc2pW0p74BBXBUuPU1hHyU+BXR92msXw5vX3oDQlIj4MDuFmPvLcnu7cPZ/BTu2TmP4xQl8WfKR1FcPQFBNG84ioJv2JkiaTjd46ko4MedCzrSFfiIO3IO5gltvQCJgoOkYDtUtArjFAm+nQ3l+eHsXPRxfPOcA3uAkTEPxXH2AATholYObBeL0GgAvl1B0siNH9N4+rTBwfbHRCMeaA0IRRIFh2eio3JJ/NMUz4dI6M/K8XF47JctAaE4IuHA/gjZyFZEAEur1Y6xxDSK/kVxtgIE8aLgIGDssx2lUVB7Xymy/etR9rdVo6H/baVpAQjFGwkHSWqrmn02CmrvN6/tVust7H15YgV/gZzcPuk/bJ9oQBAwGg7mGDEB+F1amFFxUvBPbdMXONg+HTNsv0hAeOdVcFyXBpBkKbQnfgA0cFxHNdHZCEC2H0tgGyUViaK4ouy3tJul4ND0LG7gwc9ZND+L88dxb0CAgpWD7Y/JnA6QyOUS5aRdjRn0Bg4gqRk/zpgDTz0BoWiB42Aat0Mki3ncDMrQtwIAQNsOsA8YS+vtBQgiRj5vkLTlk4UIjdoGB9tGU+acxgMQVo1IOEgScLDNqeI8XrFC09B7nqgMkVgA4TkDONgaXDgdSqJ+eZ8lWYLjLUSDT3TmbqDBVGNMYQXEGw4SBBCAoUSNUUNTe2kBhAKmkGlc7WkUeIlg9GfcBgVbjpXYUF8pEKaABZC9U8BCo8ABhsb+UePc1jjPOEGxV1P7aRTwAuQoIIr+qB311TEpkFKBSEBSBiynpECJAgKkRC31XU6BAQBZLicKOJECAiRRMuRKPgUESL6cyKNECgiQRMmQK/kUECD5ciKPEimwNiCJEiFXciogQHLmRV4lUUCAJEmE3MipgADJmRd5lUQBAZIkEXIjpwICJCgvMjuHAv8HAAD//2RwFIwAAAAGSURBVAMAM/KLr3yiZGYAAAAASUVORK5CYII=' },
      { name: 'GitHub', url: 'https://github.com/search?q=', icon: 'data:image/png;base64,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' },
    ];

    // 保存到内存和数据库
    for (const engine of engines) {
      this.searchEngines.set(engine.name.toLowerCase(), engine);
      await this.saveSearchEngineToDatabase(engine);
    }

    console.log('搜索引擎初始化完成，总数:', this.searchEngines.size);
  }

  // ========== 数据库加载相关 ==========

  /**
   * 从数据库加载默认搜索引擎名称
   */
  private async loadDefaultEngineName(): Promise<void> {
    try {
      const { dbManager } = await import('../database/db');
      const config = await dbManager.getItemById(this.CONFIG_ITEM_ID);
      if (config?.description) {
        const configData = JSON.parse(config.description);
        this.defaultEngine = configData.defaultEngine || this.DEFAULT_ENGINE_NAME;
        console.log('从数据库加载默认搜索引擎:', this.defaultEngine);
      }
    } catch (error) {
      console.log('未找到默认搜索引擎配置，使用默认值');
    }
  }

  /**
   * 从数据库加载搜索引擎
   */
  private async loadSearchEnginesFromDatabase(): Promise<void> {
    try {
      const { dbManager } = await import('../database/db');
      const items = await dbManager.getAllItems('search-engine');
      
      for (const item of items) {
        const config = this.parseSearchEngineConfig(item.description);
        const engineKey = this.removeSearchEnginePrefix(item.id).toLowerCase();
        
        this.searchEngines.set(engineKey, {
          name: item.name,
          url: item.path,
          default: config.default ?? (engineKey === this.defaultEngine.toLowerCase()),
          icon: item.icon || this.getDefaultSearchEngineIcon(item.name),
        });
      }
      
      console.log(`从数据库加载了 ${this.searchEngines.size} 个搜索引擎`);
    } catch (error) {
      console.error('从数据库加载搜索引擎失败:', error);
    }
  }

  /**
   * 解析搜索引擎配置
   */
  private parseSearchEngineConfig(description?: string | null): SearchEngineConfigData {
    if (!description) return { default: false };
    try {
      return JSON.parse(description);
    } catch {
      return { default: false };
    }
  }

  /**
   * 移除搜索引擎ID前缀
   */
  private removeSearchEnginePrefix(id: string): string {
    return id.replace(this.SEARCH_ENGINE_PREFIX, '');
  }

  // ========== 数据库保存相关 ==========

  /**
   * 获取默认搜索引擎图标
   */
  private getDefaultSearchEngineIcon(_name: string): string {
    // 如果没有图标，返回默认的浏览器图标（紫色地球图标）
    return 'data:image/png;base64,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';
  }

  /**
   * 保存搜索引擎到数据库
   */
  private async saveSearchEngineToDatabase(engine: SearchEngine): Promise<void> {
    const configData: SearchEngineConfigData = {
      default: engine.default || false,
      addedAt: new Date().toISOString(),
    };

    // 如果没有图标，使用默认图标
    const icon = engine.icon || this.getDefaultSearchEngineIcon(engine.name);

    try {
      const { dbManager } = await import('../database/db');
      await dbManager.upsertItem({
        id: `${this.SEARCH_ENGINE_PREFIX}${engine.name}`,
        type: 'search-engine',
        name: engine.name,
        path: engine.url,
        icon: icon,
        category: 'search-engine',
        description: JSON.stringify(configData),
        launchCount: 0,
        lastUsed: undefined,
        score: engine.default ? 100 : 0,
        indexedAt: new Date(),
        searchKeywords: engine.name.toLowerCase(),
      });
    } catch (error) {
      console.error(`保存搜索引擎 ${engine.name} 到数据库失败:`, error);
    }
  }

  /**
   * 保存默认搜索引擎配置到数据库
   */
  private async saveDefaultEngineName(): Promise<void> {
    const configData = {
      defaultEngine: this.defaultEngine,
      updatedAt: new Date().toISOString(),
    };

    try {
      const { dbManager } = await import('../database/db');
      await dbManager.upsertItem({
        id: this.CONFIG_ITEM_ID,
        type: 'config',
        name: '搜索引擎配置',
        path: '',
        description: JSON.stringify(configData),
        category: 'config',
        launchCount: 0,
        lastUsed: undefined,
        score: 0,
        indexedAt: new Date(),
      });
      
      console.log('已保存默认搜索引擎配置到数据库:', this.defaultEngine);
    } catch (error) {
      console.error('保存默认搜索引擎配置到数据库失败:', error);
    }
  }

  // ========== 公共 API ==========

  /**
   * 添加搜索引擎
   */
  public async addSearchEngine(engine: SearchEngine): Promise<void> {
    this.searchEngines.set(engine.name.toLowerCase(), engine);
    await this.saveSearchEngineToDatabase(engine);
    await this.saveDefaultEngineName();
    console.log(`已添加搜索引擎: ${engine.name}`);
  }

  /**
   * 更新搜索引擎
   */
  public async updateSearchEngine(name: string, updates: Partial<SearchEngine>): Promise<void> {
    const engine = this.searchEngines.get(name.toLowerCase());
    if (!engine) return;

    Object.assign(engine, updates);
    this.searchEngines.set(name.toLowerCase(), engine);
    await this.saveSearchEngineToDatabase(engine);
    await this.saveDefaultEngineName();
    console.log(`已更新搜索引擎: ${name}`);
  }

  /**
   * 删除搜索引擎
   */
  public async deleteSearchEngine(name: string): Promise<void> {
    this.searchEngines.delete(name.toLowerCase());
    
    try {
      const { dbManager } = await import('../database/db');
      await dbManager.deleteItem(`${this.SEARCH_ENGINE_PREFIX}${name}`);
      console.log(`已从数据库删除搜索引擎: ${name}`);
    } catch (error) {
      console.error('从数据库删除搜索引擎失败:', error);
    }
    
    await this.saveDefaultEngineName();
  }

  /**
   * 获取所有搜索引擎
   */
  public getAllEngines(): SearchEngine[] {
    return Array.from(this.searchEngines.values());
  }

  /**
   * 设置默认搜索引擎
   */
  public async setDefaultEngine(name: string): Promise<void> {
    // 重置所有引擎的 default 标志
    this.searchEngines.forEach((engine, key) => {
      engine.default = key === name.toLowerCase();
    });
    
    this.defaultEngine = name;
    
    // 更新数据库
    await this.updateSearchEnginesInDatabase();
    await this.saveDefaultEngineName();
    
    console.log(`已设置默认搜索引擎: ${name}`);
  }

  /**
   * 更新数据库中所有搜索引擎的状态
   */
  private async updateSearchEnginesInDatabase(): Promise<void> {
    for (const engine of this.searchEngines.values()) {
      const configData: SearchEngineConfigData = {
        default: engine.default ?? false,
        updatedAt: new Date().toISOString(),
      };

      try {
        const { dbManager } = await import('../database/db');
        await dbManager.upsertItem({
          id: `${this.SEARCH_ENGINE_PREFIX}${engine.name}`,
          type: 'search-engine',
          name: engine.name,
          path: engine.url,
          icon: engine.icon,
          category: 'search-engine',
          description: JSON.stringify(configData),
          score: engine.default ? 100 : 0,
          indexedAt: new Date(),
          searchKeywords: engine.name.toLowerCase(),
        });
      } catch (error) {
        console.error(`更新搜索引擎 ${engine.name} 到数据库失败:`, error);
      }
    }
  }

  /**
   * 获取默认搜索引擎
   */
  public getDefaultEngine(): SearchEngine {
    const defaultKey = this.defaultEngine.toLowerCase();
    const engine = this.searchEngines.get(defaultKey);
    
    if (engine) {
      console.log('找到默认搜索引擎:', engine.name);
      return engine;
    }
    
    // 如果找不到，返回第一个可用的
    const firstEngine = Array.from(this.searchEngines.values())[0];
    if (firstEngine) {
      console.log('使用第一个可用的搜索引擎:', firstEngine.name);
      return firstEngine;
    }
    
    console.error('没有可用的搜索引擎');
    return null as any;
  }

  /**
   * 搜索网页
   */
  public async searchWeb(query: string, engineName?: string): Promise<WebSearchResult[]> {
    console.log('搜索网页:', query, engineName);
    
    // 如果指定了搜索引擎，只返回该引擎的结果
    if (engineName) {
      const engine = this.searchEngines.get(engineName.toLowerCase());
      if (!engine) {
        console.log('未找到指定搜索引擎:', engineName);
        return [];
      }
      
      const searchUrl = `${engine.url}${encodeURIComponent(query)}`;
      const id = `web-${query}-${engine.name}`;
      
      return [{
        id,
        type: 'web',
        title: `在 ${engine.name} 搜索 "${query}"`,
        url: searchUrl,
        searchUrl,
        icon: engine.icon,
      }];
    }
    
    // 没有指定搜索引擎，返回多个主要搜索引擎选项
    const mainEngines = ['百度', 'Google', 'Bing', 'GitHub'];
    const results: WebSearchResult[] = [];
    
    for (const engineName of mainEngines) {
      const engine = this.searchEngines.get(engineName.toLowerCase());
      if (!engine) continue;
      
      const searchUrl = `${engine.url}${encodeURIComponent(query)}`;
      const id = `web-${query}-${engine.name}`;
      
      results.push({
        id,
        type: 'web',
        title: `在 ${engine.name} 搜索 "${query}"`,
        url: searchUrl,
        searchUrl,
        icon: engine.icon,
      });
    }
    
    // 添加到搜索历史
    if (results.length > 0) {
      this.addToHistory(query, results[0].searchUrl);
    }
    
    console.log('返回网页搜索结果:', results.length, '个选项');
    return results;
  }

  /**
   * 添加搜索历史
   */
  private addToHistory(query: string, url: string): void {
    const id = `history-${query}`;
    const existing = this.searchHistory.get(id);

    if (existing) {
      existing.count++;
      existing.timestamp = new Date();
    } else {
      this.searchHistory.set(id, {
        id,
        query,
        url,
        timestamp: new Date(),
        count: 1,
      });
    }

    // 限制历史记录数量
    if (this.searchHistory.size > 100) {
      const sorted = Array.from(this.searchHistory.values())
        .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());
      const toRemove = sorted.slice(50);
      toRemove.forEach(item => this.searchHistory.delete(item.id));
    }
  }

  /**
   * 获取搜索历史
   */
  public getSearchHistory(limit: number = 10): WebSearchHistory[] {
    return Array.from(this.searchHistory.values())
      .sort((a, b) => b.count - a.count)
      .slice(0, limit);
  }

  /**
   * 清除搜索历史
   */
  public clearSearchHistory(): void {
    this.searchHistory.clear();
  }

  /**
   * 打开搜索 URL
   */
  public async openSearchUrl(url: string): Promise<void> {
    try {
      await browserService.openUrl(url);
      console.log('已打开网页搜索:', url);
    } catch (error) {
      console.error('打开网页失败:', error);
      throw error;
    }
  }

  /**
   * 获取常用网站
   */
  public getCommonSites(): WebSearchResult[] {
    const sites = [
      { name: 'GitHub', url: 'https://github.com', icon: '🎯' },
      { name: 'Google', url: 'https://www.google.com', icon: '🔍' },
      { name: '知乎', url: 'https://www.zhihu.com', icon: '💡' },
      { name: 'Stack Overflow', url: 'https://stackoverflow.com', icon: '💬' },
      { name: 'MDN Web Docs', url: 'https://developer.mozilla.org', icon: '📚' },
      { name: 'Google Scholar', url: 'https://scholar.google.com', icon: '🎓' },
    ];

    return sites.map((site, index) => ({
      id: `site-${index}`,
      type: 'web' as const,
      title: site.name,
      url: site.url,
      searchUrl: site.url,
      icon: site.icon,
    }));
  }
}

export const webService = new WebService();
export default webService;

console.log('WebService 模块已加载');
